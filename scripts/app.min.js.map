{"version":3,"sources":["search.js","load-partial.js","main.js","app.js"],"names":["addSearchHandler","$searchInput","$","$searchInputLabel","focus","html","blur","val","keydown","e","keyCode","preventDefault","$searchResult","$searchActions","find","searchString","replace","trim","parent","MaterialTextfield","change","idx","result","search","filter","elem","fav","indexOf","data","ref","id","length","showMsg","hasClass","transition","allPagesCount","Math","ceil","currPageCount","$searchActionPrev","$searchActionNext","appendResults","attr","removeAttr","slice","forEach","resultIndex","append","generateResultTemplate","componentHandler","upgradeAllRegistered","click","location","href","errorReport","colorSeries","colors","map","textColors","resultEntry","colorIndex","corrIsFirst","authorHTML","author","index","corr_name","join","title","first_email","affl","corr_email","content","category","poster_num","$target","target","parentElement","$currTarget","currentTarget","currArticleId","toggleClass","favIndex","isFav","splice","push","window","localforage","setItem","taphold","isMobile","MaterialTooltip","boundMouseEnterHandler","loadPartial","load","this","$parent","$arrow","prev","children","$next","nextAll","hasAttribute","clickTab","searchGroup","split","categoryIndex","findIndex","trigger","Event","rotate","parseInt","deg","animate","duration","easing","step","now","css","isPhone","addClass","appendTo","swiperObj","Swiper","autoHeight","spaceBetween","roundLengths","navigation","nextEl","prevEl","one","update","next","test","navigator","userAgent","skipA2HS","tabId","checkDeferredPrompt","deferredPrompt","remove","prompt","userChoice","then","choiceResult","outcome","alert","message","actionHandler","arguments","undefined","actionText","timeout","sb","MaterialSnackbar","showSnackbar","hideSnackbar","init","ajaxSetup","error","xhr","status","exception","setTimeout","getJSON","data_","lunr","Index","config","driver","INDEXEDDB","WEBSQL","LOCALSTORAGE","name","getItem","err","isLocalhost","Boolean","hostname","match","protocol","serviceWorker","register","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","reload","Error","catch","console","addEventListener"],"mappings":"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","file":"app.min.js","sourcesContent":["'use strict';\n\nfunction addSearchHandler() {\n\n  let $searchInput = $('#searchInput');\n  let $searchInputLabel = $('#searchInputLabel');\n\n  $searchInput.focus(() => {\n    $searchInputLabel.html('Search...');\n  }).blur(() => {\n    if ($searchInput.val() === '')\n      $searchInputLabel.html('Search...');\n  }).keydown((e) => {\n\n    if (e.keyCode !== 13) return true; // $.ui.keyCode.ENTER\n    e.preventDefault();\n\n    let $searchResult = $('#searchResult');\n    let $searchActions = $('#abstract').find('.mdl-card__actions');\n    let searchString = $searchInput.val().replace(/[^a-zA-Z0-9+\\-*:]+/ig, \" \").trim();\n\n    $searchInput.parent()[0].MaterialTextfield.change(searchString);\n    $searchResult.html('');\n\n    if (idx === null) {\n      showMsg('Abstracts load error.', () => {\n        location.href = errorReport;\n      }, 'Report');\n      return;\n    }\n\n    let result = idx.search((searchString === '' || searchString === ':fav') ? '*' : searchString);\n    if (searchString === ':fav') {\n      result = result.filter((elem) => fav.indexOf(data[elem.ref].id) > -1);\n    }\n\n    if (result.length === 0) {\n      showMsg(`No ${searchString === ':fav' ? 'favorites' : 'result'}.`, () => {\n        $searchInput.parent()[0].MaterialTextfield.change('');\n      }, 'Clear Input');\n      if (!$searchActions.hasClass('hidden')) $searchActions.transition('fade out');\n      return;\n    }\n\n    // auto paging\n    let allPagesCount = Math.ceil(result.length / 18); // maybe use bitwise operator?\n    let currPageCount = 1;\n    let $searchActionPrev = $('#searchActionPrev');\n    let $searchActionNext = $('#searchActionNext');\n\n    let appendResults = () => {\n      $searchResult.html('');\n      if (currPageCount === 1) {\n        $searchActionPrev.attr('disabled', 'disabled');\n      } else {\n        $searchActionPrev.removeAttr('disabled');\n      }\n      if (currPageCount === allPagesCount) {\n        $searchActionNext.attr('disabled', 'disabled');\n      } else {\n        $searchActionNext.removeAttr('disabled');\n      }\n      result.slice((currPageCount - 1) * 18, currPageCount * 18).forEach((elem, resultIndex) => {\n        $searchResult.append(generateResultTemplate(elem, resultIndex));\n      }); // if slice(a, b) and b is greater than arr.length, slice will take b as arr.length so no problem.\n      $('#searchActionPageNum').html(`${currPageCount} / ${allPagesCount}`);\n      componentHandler.upgradeAllRegistered();\n    };\n\n    appendResults();\n    $searchActionPrev.click(() => {\n      currPageCount -= 1;\n      appendResults();\n    });\n    $searchActionNext.click(() => {\n      currPageCount += 1;\n      appendResults();\n    });\n\n    componentHandler.upgradeAllRegistered();\n    if ($searchActions.hasClass('hidden')) {\n      $searchActions.transition('fade in');\n    }\n\n  });\n}\n\n\nfunction generateResultTemplate(elem, resultIndex) {\n\n  let colorSeries = ['deep-purple-300', 'deep-purple-400', 'indigo-500', 'indigo-400'];\n  let colors = colorSeries.map((e) => 'mdl-color--' + e);\n  let textColors = colorSeries.map((e) => 'mdl-color-text--' + e);\n\n  let resultEntry = data[elem.ref];\n  let colorIndex = resultIndex % colors.length;\n\n  let corrIsFirst; // whether correlating author is presenting author\n  let authorHTML = resultEntry.author.map((val, index) => {\n    if (val === resultEntry.corr_name) {\n      corrIsFirst = (index === 0);\n      return `${val}*`;\n    }\n    else return val;\n  });\n  authorHTML[0] += '<sup>&ddagger;</sup>';\n  authorHTML = authorHTML.join('; ');\n\n  return $(`\n          <div class=\"mdl-card mdl-cell mdl-shadow--2dp result-unit\n                      mdl-cell--6-col-desktop mdl-cell--8-col-tablet mdl-cell--4-col-phone\"\n               data-article-id=\"${resultEntry.id}\" data-result-id=\"${resultIndex}\">\n            <div class=\"mdl-card__title mdl-color-text--white ${colors[colorIndex]}\"\n                 style=\"min-height: 80px;\">\n              <h4 class=\"mdl-card__title-text\" style=\"margin-top: 30px; font-size: 20px;\">${resultEntry.title}</h4>\n            </div>\n            <div class=\"mdl-card__supporting-text\" style=\"padding: 0 20px;\">\n              <span class=\"result-content hidden\">\n                <h6 style=\"margin: 8px;\">${authorHTML}</h6>\n                <p style=\"margin-bottom: 6px;\">\n                  ${corrIsFirst ? '*' : ''}<sup>&ddagger;</sup>\n                  Presenting${corrIsFirst ? ' and corresponding' : ''}:\n                  ${resultEntry.first_email}, ${resultEntry.affl}\n                </p>\n                ${corrIsFirst ? '' : `<p>* Corresponding: ${resultEntry.corr_email}</p>`}\n                <hr /><p style=\"line-height: 18px;\">${resultEntry.content}</p>\n              </span>\n            </div>\n            <div class=\"mdl-card__actions\">\n              <div class=\"mdl-button mdl-js-button mdl-js-ripple-effect ${textColors[colorIndex]} toggle-button\">\n                Toggle Details\n              </div>\n            </div>\n            <div class=\"category-info\">\n              <p>${resultEntry.category}: ${resultEntry.poster_num}</p>\n            </div>\n            <button class=\"mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon fav-button\" \n                    id=\"favButton${resultIndex}\">\n              <i class=\"material-icons mdl-color-text--white fav-icon\">\n                ${fav.indexOf(resultEntry.id) > -1 ? 'star' : 'star_border'}\n              </i>\n            </button>\n            <div class=\"mdl-tooltip mdl-tooltip--large mdl-tooltip--left\"\n                 data-mdl-for=\"favButton${resultIndex}\" data-mdl-taphold=\"true\">\n              ${fav.indexOf(resultEntry.id) > -1 ? 'Remove from' : 'Add to'} favorites\n            </div>\n          </div>\n        `).click((e) => {\n\n          let $target = $(e.target.parentElement);\n          let $currTarget = $(e.currentTarget);\n          let currArticleId = $currTarget.attr('data-article-id');\n\n          if ($target.hasClass('toggle-button')) {\n\n            $currTarget.find('.result-content').toggleClass('hidden');\n            return false;\n\n          } else if ($target.hasClass('fav-button')) {\n\n            let favIndex = fav.indexOf(currArticleId);\n            let isFav = favIndex > -1;\n            $currTarget.find('.fav-icon').html(`star${isFav ? '_border' : ''}`);\n            if (isFav) {\n              fav.splice(favIndex, 1);\n            } else {\n              fav.push(currArticleId);\n            }\n            $currTarget.find('.mdl-tooltip').html(`${isFav ? 'Add to' : 'Remove from'} favorites`);\n            showMsg(`${isFav ? 'Removed from' : 'Added to'} favorites.`);\n            window.localforage.setItem('favorites', fav);\n            return false;\n          }\n\n        }).taphold((e) => {\n          if ($(e.target.parentElement).hasClass('fav-button') && isMobile) {\n            $(e.currentTarget).find('.mdl-tooltip')[0].MaterialTooltip.boundMouseEnterHandler(e);\n          }\n          return false;\n        });\n}\n","\n'use strict';\n\nfunction loadPartial() {\n\n  $('#home-partial').load('partial/home-partial.html', () => {\n    componentHandler.upgradeAllRegistered();\n  });\n\n\n  $('#topics').load('partial/topics-partial.html', () => {\n\n    componentHandler.upgradeAllRegistered();\n\n    $('#topics').find('.mdl-button__ripple-container').click(function () {\n\n      let $target = $(this), $parent = $target.parent();\n      let $arrow = $target.prev().children(':first'), $next = $target.parent().nextAll();\n\n      if (!$parent[0].hasAttribute('data-expansion')) {\n\n        if (!$parent[0].hasAttribute('data-category')) return false;\n        clickTab('#tabAbstract');\n        let $searchInput = $('#searchInput');\n        let searchGroup = $searchInput.val().replace(/[^a-zA-Z0-9+\\-*:]+/ig, \" \").split(' ');\n        let categoryIndex = searchGroup.findIndex((e) => e.slice(0, 9) === 'category:');\n        if (categoryIndex > -1) searchGroup.splice(categoryIndex, 1);\n        $searchInput.parent()[0]\n          .MaterialTextfield.change(`${searchGroup.join(' ')} category:${$parent.attr('data-category')}`);\n        $searchInput.trigger($.Event('keydown', { keyCode: 13 }));  // $.ui.keyCode.ENTER\n        return false;\n\n      }\n\n      let rotate = parseInt($arrow.attr('data-rotate')) || 0; // 0 or 1\n      $arrow.attr('data-rotate', 1 - rotate);\n      $({ deg: rotate * 180 }).animate({ deg: (1 - rotate) * 180 }, {\n        duration: 200,\n        easing: 'swing',\n        step: (now) => {\n          $arrow.css('transform', `rotate(${now}deg)`);\n        }\n      });\n      $next.slice(0, parseInt($parent.attr('data-expansion'))).toggleClass('hidden');\n    });\n\n  });\n\n\n  $('#schedule').load('partial/schedule-partial.html', () => {\n\n    if (isPhone) {\n      // init swiper\n      $('#schedule-partial').addClass('swiper-container')\n        .children().addClass('swiper-slide').css('margin-left', '0')\n        .appendTo('<div class=\"swiper-wrapper\"></div>')\n        .parent().appendTo('#schedule-partial')\n        .parent().append('<div class=\"swiper-button-prev\"></div><div class=\"swiper-button-next\"></div>');\n\n      swiperObj = new Swiper('.swiper-container', {\n        autoHeight: true,\n        spaceBetween: 70,\n        roundLengths: true,\n        navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' }\n      });\n      $('#tabSchedule').one('click', '.mdl-layout__tab-ripple-container', () => {\n        // swiper should be initialized when it's visible. https://github.com/nolimits4web/swiper/issues/2276\n        swiperObj.update();\n      })\n    }\n\n    componentHandler.upgradeAllRegistered();\n\n    $('#schedule').find('.mdl-button__ripple-container').click(function () {\n\n      let $target = $(this), $arrow = $target.prev().children(':first'), $next = $target.parent().next();\n      if (!$target.hasClass('mdl-button__ripple-container')) return false;\n      let rotate = parseInt($arrow.attr('data-rotate')) || 0; // 0 or 1\n      $arrow.attr('data-rotate', 1 - rotate);\n      $({ deg: rotate * 180 }).animate({ deg: (1 - rotate) * 180 }, {\n        duration: 200,\n        easing: 'swing',\n        step: (now) => {\n          $arrow.css('transform', `rotate(${now}deg)`);\n        }\n      });\n      $next.toggleClass('hidden');\n    });\n\n  });\n\n}\n","\n'use strict';\n\n\nlet data = null;\nlet idx = null;\nlet errorReport = null;\nlet fav = [];\nlet isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);\nlet isPhone = /Android|iPhone|iPod|BlackBerry/i.test(navigator.userAgent);\nlet swiperObj = null;\nlet skipA2HS = () => { $('.mdl__loader.non-standalone').transition('fade out'); };\nlet clickTab = (tabId) => { $(tabId).find('span').click(); };\n\nfunction checkDeferredPrompt() {\n  if (deferredPrompt !== null) {\n    $('#installPromptTooltip').remove();\n    deferredPrompt.prompt();\n    deferredPrompt.userChoice.then(function(choiceResult) {\n      if (choiceResult.outcome === 'dismissed') {\n        showMsg('Installation cancelled. You can still manually install by tapping' +\n          ' \"Add to Home Screen\" option in your browser\\'s menu.', () => {}, 'OK', 10000);\n      } else {\n        alert('NT18 OnAir successfully installed.');\n      }\n    });\n  }\n}\n\nfunction showMsg(message, actionHandler = () => {}, actionText = 'OK', timeout = 3000) {\n  let sb = $('#msgContainer')[0].MaterialSnackbar;\n  sb.showSnackbar({\n    message: message,\n    timeout: timeout,\n    actionHandler: () => { actionHandler(); sb.hideSnackbar(); },\n    actionText: actionText\n  });\n}\n\nfunction init() {\n\n  /* Init all components and functions */\n\n  $.ajaxSetup({\n    error: (xhr, status, exception) => {\n      errorReport = `mailto:accel@pku.edu.cn?subject=NT18 OnAir Bug&body=status:${status}; exception:${exception}`;\n      setTimeout(() => {\n        showMsg('Load error.', () => {\n          location.href = errorReport;\n        }, 'Report');\n      }, 3000);\n    }\n  });\n\n  // process HTML\n\n  loadPartial();\n\n  $('#filterButton').click(() => {\n    clickTab('#tabTopics');\n  }).taphold((e) => {\n    if (isMobile) {\n      $('.filter-button-tooltip')[0].MaterialTooltip.boundMouseEnterHandler(e);\n    }\n    return false;\n  });\n\n  // process data and search\n\n  let localforage = window.localforage;\n\n  $.getJSON('data/abstracts.json', function (data_) { data = data_; });\n  $.getJSON('data/abstracts-indexed.json', function (data_) { idx = lunr.Index.load(data_); });\n\n  localforage.config({\n    driver: [localforage.INDEXEDDB, localforage.WEBSQL, localforage.LOCALSTORAGE],\n    name: 'NT18 OnAir'\n  });\n\n  localforage.getItem('favorites', function (err, val) {\n    if (val === null) {\n      localforage.setItem('favorites', fav);\n    } else {\n      fav = val;\n    }\n  });\n\n  addSearchHandler();\n\n  componentHandler.upgradeAllRegistered();\n\n}\n\n","\n/* eslint-env browser */\n\nlet deferredPrompt = null;\n\n(function() {\n  'use strict';\n\n  // Check to make sure service workers are supported in the current browser,\n  // and that the current page is accessed from a secure origin. Using a\n  // service worker from an insecure origin will trigger JS console errors. See\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\n  let isLocalhost = Boolean(window.location.hostname === 'localhost' ||\n      // [::1] is the IPv6 localhost address.\n      window.location.hostname === '[::1]' ||\n      // 127.0.0.1/8 is considered localhost for IPv4.\n      window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n      )\n    );\n\n  if ('serviceWorker' in navigator &&\n      (window.location.protocol === 'https:' || isLocalhost)) {\n    navigator.serviceWorker.register('service-worker.js')\n    .then(function(registration) {\n      // updatefound is fired if service-worker.js changes.\n      registration.onupdatefound = function() {\n        // updatefound is also fired the very first time the SW is installed,\n        // and there's no need to prompt for a reload at that point.\n        // So check here to see if the page is already controlled,\n        // i.e. whether there's an existing service worker.\n        if (navigator.serviceWorker.controller) {\n          // The updatefound event implies that registration.installing is set:\n          // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\n          let installingWorker = registration.installing;\n\n          installingWorker.onstatechange = function() {\n            switch (installingWorker.state) {\n              case 'installed':\n                // new content prompt\n                showMsg('New content is available.', () => {\n                  location.reload(true); // true or false doesn't matter?\n                }, 'Reload', 5000);\n                break;\n\n              case 'redundant':\n                throw new Error('The installing ' +\n                                'service worker became redundant.');\n\n              default:\n                // Ignore\n            }\n          };\n        }\n      };\n    }).catch(function(e) {\n      console.error('Error during service worker registration:', e);\n    });\n  }\n\n  window.addEventListener('beforeinstallprompt', function (e) {\n    e.preventDefault();\n    deferredPrompt = e;\n    return false;\n  });\n\n  $(init);\n\n})();\n"]}