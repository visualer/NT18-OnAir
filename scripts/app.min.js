"use strict";function showMsg(t,n,e){var o=document.querySelector("#msgContainer");o.MaterialSnackbar.showSnackbar({message:t,timeout:3e3,actionHandler:n,actionText:e})}function init(){$.ajaxSetup({error:function(t,n,e){errorReport="mailto:accel@pku.edu.cn?subject=NT18 OnAir Bug&body=status:"+n+"; exception:"+e,setTimeout(function(){showMsg("Load error",function(){location.href=errorReport},"Report")},3e3)}}),$.getJSON("data/abstracts.json",function(t){data=t,idx=lunr(function(){this.ref("id"),this.field("title"),this.field("lab"),this.field("content"),this.field("author"),data.forEach(function(t){this.add({id:t.id,title:t.title,author:t.author.join(" "),lab:t.lab.join(" "),content:t.content,mapping:t.mapping})},this)})}),LocalForage.config({driver:LocalForage.INDEXEDDB,name:"NT18 OnAir"}),LocalForage.getItem("favorites",function(t,n){null===n?LocalForage.setItem("favorites",fav):fav=n}),addSearchHandler(),$("#schedule").load("partial/schedule.html"),componentHandler.upgradeAllRegistered()}function addSearchHandler(){var t=["deep-purple-300","deep-purple-400","indigo-500","indigo-400"],n=t.map(function(t){return"mdl-color--"+t}),e=t.map(function(t){return"mdl-color-text--"+t});$("#searchInput").keydown(function(t){var o=$("#searchResult"),a=$("#searchInput"),r=$("#abstract").find(".mdl-card__actions");if(13!==t.keyCode)return!0;if(t.preventDefault(),null===idx)return void showMsg("Abstracts load error",function(){location.href=errorReport},"Report");o.html("");var i=idx.search(a.val());return 0===i.length?(showMsg("No result",function(){a.val("")},"Clear Input"),void(r.hasClass("hidden")||r.transition("fade out"))):(r.hasClass("hidden")&&r.transition("fade in"),i.forEach(function(t,a){var r=data[t.ref],i=r.author.map(function(t,n){return t+"<sup>"+r.mapping[n]+"</sup>"}).join(", "),l=r.lab.map(function(t,n){return"("+(n+1)+") "+t}).join(", "),d=a%n.length;o.append($('\n          <div class="mdl-card mdl-cell mdl-shadow--2dp result-units hidden\n                      mdl-cell--12-col-desktop mdl-cell--8-col-tablet mdl-cell--4-col-phone"\n               data-article-id="'+r.id+'">\n            <div class="mdl-card__title mdl-color-text--white '+n[d]+'"\n                 style="min-height: 80px;">\n              <h4 class="mdl-card__title-text" style="margin-top: 30px;">'+r.title+'</h4>\n            </div>\n            <div class="mdl-card__supporting-text">\n              <h6 style="margin: 12px;">'+i+"</h6><br /><p>"+l+'</p>\n              <span class="resultInnerContent hidden"><hr />'+r.content+'</span>\n            </div>\n            <div class="mdl-card__actions">\n              <div class="mdl-button mdl-js-button mdl-js-ripple-effect '+e[d]+' toggle-button">\n                Toggle Content\n              </div>\n            </div>\n            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon fav-button">\n              <i class="material-icons mdl-color-text--white">\n                '+(fav.indexOf(r.id)>-1?"star":"star_border")+"\n              </i>\n            </button>\n          </div>\n        ").click(function(t){var n=$(t.target.parentElement);if(n.hasClass("toggle-button"))$(t.currentTarget).find(".resultInnerContent").toggleClass("hidden");else if(n.hasClass("fav-button")){var e=fav.indexOf(r.id),o=e>-1;n.find("i").html("star"+(o?"_border":"")),o?fav.splice(e,1):fav.push(r.id),showMsg((o?"Removed from":"Added to")+" favorites",null,null),LocalForage.setItem("favorites",fav)}}))}),componentHandler.upgradeAllRegistered(),void $(".result-units").transition({animation:"slide down",duration:200,interval:100}))})}function skipA2HS(){$(".mdl__loader.non-standalone").transition("fade out")}var data=null,idx=null,errorReport=null,LocalForage=window.localforage,fav=[];!function(){var t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&("https:"===window.location.protocol||t)&&navigator.serviceWorker.register("service-worker.js").then(function(t){t.onupdatefound=function(){if(navigator.serviceWorker.controller){var n=t.installing;n.onstatechange=function(){switch(n.state){case"installed":$(".newContentPrompt").transition("slide down");break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})["catch"](function(t){console.error("Error during service worker registration:",t)}),$(init)}();
//# sourceMappingURL=app.min.js.map
