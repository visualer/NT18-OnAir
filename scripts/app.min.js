"use strict";function showMsg(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK",o=document.querySelector("#msgContainer").MaterialSnackbar;o.showSnackbar({message:t,timeout:3e3,actionHandler:function(){n(),o.hideSnackbar()},actionText:e})}function init(){$.ajaxSetup({error:function(t,n,e){errorReport="mailto:accel@pku.edu.cn?subject=NT18 OnAir Bug&body=status:"+n+"; exception:"+e,setTimeout(function(){showMsg("Load error",function(){location.href=errorReport},"Report")},3e3)}}),$.getJSON("data/abstracts.json",function(t){data=t,idx=lunr(function(){this.ref("id"),this.field("title"),this.field("lab"),this.field("content"),this.field("author"),data.forEach(function(t){this.add({id:t.id,title:t.title,author:t.author.join(" "),lab:t.lab.join(" "),content:t.content,mapping:t.mapping})},this)})}),LocalForage.config({driver:LocalForage.INDEXEDDB,name:"NT18 OnAir"}),LocalForage.getItem("favorites",function(t,n){null===n?LocalForage.setItem("favorites",fav):fav=n}),addSearchHandler(),$("#schedule").load("partial/schedule.html"),componentHandler.upgradeAllRegistered()}function addSearchHandler(){var t=["deep-purple-300","deep-purple-400","indigo-500","indigo-400"],n=t.map(function(t){return"mdl-color--"+t}),e=t.map(function(t){return"mdl-color-text--"+t}),o=$("#searchInput"),a=o.parent().children("label");o.focus(function(){a.html("Search...")}),o.blur(function(){""===o.val()&&a.html('Search... or enter ":all" ":fav"')}),o.keydown(function(t){var o=$("#searchResult"),a=$("#searchInput"),i=$("#abstract").find(".mdl-card__actions");if(13!==t.keyCode)return!0;if(t.preventDefault(),null===idx)return void showMsg("Abstracts load error",function(){location.href=errorReport},"Report");o.html("");var r=a.val(),l=idx.search(":all"===r||":fav"===r?"*":r);return":fav"===r&&(l=l.filter(function(t){return fav.indexOf(t.ref)>-1})),0===l.length?(showMsg("No "+(":fav"===r?"favorites":"result"),function(){a.parent()[0].MaterialTextfield.change("")},"Clear Input"),void(i.hasClass("hidden")||i.transition("fade out"))):(i.hasClass("hidden")&&i.transition("fade in"),l.forEach(function(t,a){var i=data[t.ref],r=i.author.map(function(t,n){return t+"<sup>"+i.mapping[n]+"</sup>"}).join(", "),l=i.lab.map(function(t,n){return"("+(n+1)+") "+t}).join(", "),d=a%n.length;o.append($('\n          <div class="mdl-card mdl-cell mdl-shadow--2dp result-unit hidden\n                      mdl-cell--12-col-desktop mdl-cell--8-col-tablet mdl-cell--4-col-phone">\n            <div class="mdl-card__title mdl-color-text--white '+n[d]+'"\n                 style="min-height: 80px;">\n              <h4 class="mdl-card__title-text" style="margin-top: 30px;">'+i.title+'</h4>\n            </div>\n            <div class="mdl-card__supporting-text">\n              <h6 style="margin: 12px;">'+r+"</h6><br /><p>"+l+'</p>\n              <span class="resultInnerContent hidden"><hr />'+i.content+'</span>\n            </div>\n            <div class="mdl-card__actions">\n              <div class="mdl-button mdl-js-button mdl-js-ripple-effect '+e[d]+' toggle-button"\n                   id="toggleButton'+a+'">\n                Toggle Content\n              </div>\n            </div>\n            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon fav-button" \n                    id="favButton'+a+'">\n              <i class="material-icons mdl-color-text--white">\n                '+(fav.indexOf(i.id)>-1?"star":"star_border")+'\n              </i>\n            </button>\n            <div class="mdl-tooltip mdl-tooltip--large mdl-tooltip--left" id="tooltip'+a+'"\n                 data-mdl-for="favButton'+a+'" data-mdl-taphold="true">\n              '+(fav.indexOf(i.id)>-1?"Remove from":"Add to")+" favorites\n            </div>\n          </div>\n        ").click(function(t){$(t.target.parentElement).hasClass("toggle-button")&&$(t.currentTarget).find(".resultInnerContent").toggleClass("hidden")})),$("#favButton"+a).on("click",function(){var t=fav.indexOf(i.id),n=t>-1;$(this).find("i").html("star"+(n?"_border":"")),n?fav.splice(t,1):fav.push(i.id),$("#tooltip"+a).html((n?"Add to":"Remove from")+" favorites"),showMsg((n?"Removed from":"Added to")+" favorites"),LocalForage.setItem("favorites",fav)}).on("taphold",function(t){isPC&&$("#tooltip"+a)[0].MaterialTooltip.boundMouseEnterHandler(t)})}),componentHandler.upgradeAllRegistered(),void $(".result-unit").transition({animation:"slide down",duration:200,interval:100}))})}function skipA2HS(){$(".mdl__loader.non-standalone").transition("fade out")}function clickTab(t){$(t).find("span").click(),scrollTo(0,0)}var data=null,idx=null,errorReport=null,LocalForage=window.localforage,fav=[],isPC=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);!function(){var t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&("https:"===window.location.protocol||t)&&navigator.serviceWorker.register("service-worker.js").then(function(t){t.onupdatefound=function(){if(navigator.serviceWorker.controller){var n=t.installing;n.onstatechange=function(){switch(n.state){case"installed":$(".newContentPrompt").transition("slide down");break;case"redundant":throw new Error("The installing service worker became redundant.")}}}}})["catch"](function(t){console.error("Error during service worker registration:",t)}),$(init)}();
//# sourceMappingURL=app.min.js.map
